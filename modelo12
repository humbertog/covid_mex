model{
  for(i in 1:I) {
  
    Y[i, 1:J[i]] ~ dmulti(p[1:J[i]], N[i])
    
    N[i] ~ dpois(NN[i] * sum(p[1:J[i] ]) )
    
  }
  
  for (j in 2:Jmax) {
    p[j] <- exp(-beta * (j-1)) - exp(-beta * j)
  }
  p[1] <- 1-exp(-beta * 1)



########## PRIORS:
  

beta ~ dgamma(1.0E-3, 1.0E-3)


for (i in 1:I) {
  NN[i] ~  dgamma(1.0E-3, 1.0E-3)
}

}


