model{
  for(i in 1:I) {
  
    Y[i, 1:J[i]] ~ dmulti(p[1:J[i]], N[i])
    
    N[i] ~ dpois(NN[i] * sum(p[1:J[i] ]) )
    
  }
  
  for (j in 2:Jmax) {
    p[j] <- pexp(j, beta) - pexp(j-1, beta)
  }
  p[1] <- pexp(1, beta)



########## PRIORS:
  

beta ~ dgamma(1.0E-4, 1.0E-4)


for (i in 1:I) {
  NN[i] ~  dgamma(1.0E-3, 1.0E-3)
}

}