model{
  for(i in 1:I) {
  
    Y[i, 1:J[i]] ~ dmulti(p[1:J[i]], N[i])
    
    N[i] ~ dpois(NN[i] * sum(p[1:J[i] ]))
    
    
  }
  p[1:Jmax] ~ ddirch(alpha)


for (i in 2:I) {
  NN[i] <- NN[1] + F[i-1]
  F[i-1] ~ dpois(sum(lambda[1:(i-1)]))
}  

for (i in 1:(I-1)) {
  lambda[i] ~ dgamma(1.0E-2, 1.0E-2)
}



NN[1] <- 340

for (j in 1:Jmax) {
  alpha[j] <- 1
}



}